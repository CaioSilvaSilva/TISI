<!DOCTYPE html>
<html>
	<head>
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js">
		</script>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<meta charset="utf-8"/>
	</head>
	<body ng-app="crudComBD" ng-controller="controlador">
		<div class="container-fluid">
			<table class="table"> <!-- tabela -->
				<tr> <!-- table row (nova linha)--> 
					<!-- table header (célula de cabeçalho)-->
					<th> ID</th>
					<th> Nome Projeto </th> 
					<th> Usuario </th> 
					<th> Descrição </th> 
					<th> Objetivos </th> 
					<th> Data de Início</th>
					<th> Data de Entrega</th>
					<th> Data de Termino</th>
				</tr>
				<tr ng-repeat="projeto in listaProjetos">
					<td> {{projeto.id}} </td> 
					<td> {{projeto.nome}} </td> 
					<td> {{projeto.usuario}} </td> 
					<td> {{projeto.descricao}} </td> 
					<td> {{projeto.objetivo}} </td> 
					<td> {{projeto.data_inicio}} </td> 
					<td> {{projeto.data_entrega}} </td> 
					<td> {{projeto.data_termino}} </td> 
					<td> 
						<a href="#" ng-click="remover(projeto.id)"> Remover </a> 
						||
						<a href="#" ng-click="atualizar(projeto.id)"> Atualizar </a> 
					</td>
				</tr>
			</table>
			<h2> Informações do Projeto</h2>
			ID<input type="number" class="form-control" ng-model="id"/>
			<br>Nome do Projeto<input type="text" class="form-control" ng-model="nome"/>
			<br>Usuário<input type="text" class="form-control" ng-model="usuario"/>
			<br/>Descrição<input type="text" class="form-control" ng-model="descricao"/>	
			<br/>Objetivo<input type="text" class="form-control" ng-model="objetivo"/>	
			<br/>Data Inicio<input type="text" class="form-control" ng-model="data_inicio"/>	
			<br/>Data Entrega<input type="text" class="form-control" ng-model="data_entrega"/>	
			<br/>Data Termino<input type="text" class="form-control" ng-model="data_termino"/>	
			<br/>
			<button type="button" class="btn btn-info" ng-click="inserir()"> Inserir </button>
			<button type="button" class="btn btn-info" ng-click="alterar()"> Atualizar </button>
			<br/>
			<br/>

			<script>
				var app = angular.module('crudComBD', []);
				app.controller('controlador', 
					function($scope) {
						// criar uma estrutura de dados JSON
						$scope.listaProjetos = [];
						// insere na lista
						$scope.inserir = function(){
							// adiciona novo produto em listaProdutos
							$scope.listaProjetos.push(
								{id: $scope.id,
								 nome: $scope.nome,
								 usuario: $scope.usuario,
								 descricao: $scope.descricao,
								 objetivo: $scope.objetivo,
								 data_inicio: $scope.data_inicio,
								 data_entrega: $scope.data_entrega,
								 data_termino: $scope.data_termino,
								}
							);
						}
						// remove da lista
						$scope.remover = function(id){
							var resposta = confirm("Confirma a exclusão deste elemento?");
							if (resposta == true){
								var posicao = retornaIndice(id);
								$scope.listaProjetos.splice(posicao, 1);
							}
						};
						// atualiza um produto
						$scope.atualizar = function(id){
							var posicao = retornaIndice(id);
							$scope.id= $scope.listaProjetos[posicao].id;
							$scope.nome = $scope.listaProjetos[posicao].nome;
							$scope.usuario= $scope.listaProjetos[posicao].descricao;
							$scope.objetivo= $scope.listaProjetos[posicao].objetivo;
							$scope.data_inicio= $scope.listaProjetos[posicao].data_inicio;
							$scope.data_entrega= $scope.listaProjetos[posicao].data_entrega;
							$scope.data_termino= $scope.listaProjetos[posicao].data_termino;
						}
						// editar o produto
						$scope.alterar = function(){
							// recupera o índice do produto para alterar
							var indice = retornaIndice($scope.id);
							if (indice != -1){
								$scope.listaProjetos[indice].nome= $scope.nome;
								$scope.listaProjetos[indice].usuario= $scope.usuario;
								$scope.listaProjetos[indice].descricao= $scope.descricao;
								$scope.listaProjetos[indice].data_inicio= $scope.data_inicio;
								$scope.listaProjetos[indice].data_entrega= $scope.data_entrega;
								$scope.listaProjetos[indice].data_termino= $scope.data_termino;
							}
						}
						// função que retorna a posição de um produto pelo seu código 
						function retornaIndice(id){
							var i;
							for (i=0;i<$scope.listaProjetos.length;i++){
									if ($scope.listaProjetos[i].id == id){
										return i; // retorna posição do produto desejado
									}
							}
							return -1;
						}
						
					}
				);
			</script>
			</div>
	</body>
</html>
